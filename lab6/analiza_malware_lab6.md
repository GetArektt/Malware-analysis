# Shellcode/C++ analysis


## Laboratorium 6.1

Przeprowadź analizę dynamiczną pliku Lab08-01.bin za pomocą narzędzia

shellcode_launcher.exe.


### 1. W jaki sposób jest zakodowany ten shellcode?

Są to głównie znaki ASCII

Nie udało mi się niestety znaleźć innych ciekawych zależności 





### 2. Jakie funkcje importuje ten shellcode ręcznie (wykorzystaj do tego program scdbg)?



* `LoadLibraryA`
* `GetSystemDirectoryA`
* `TerminateProcess`
* `GetCurrentProcess`
* `WinExec`
* `URLDownloadToFileA`





### 3. Podaj nazwę hosta sieciowego, z którym próbuje się komunikować ten shellcode.

[http://www.practicalmalwareanalysis.com/shellcode/annoy_user.exe](http://www.practicalmalwareanalysis.com/shellcode/annoy_user.exe)


### 4. Wskaż, jakie pozostałości pozostawia za sobą shellcode w systemie plików.


```
c:\WINDOWS\system32\1.exe
```



### Laboratorium 6.2

Przeprowadź analizę dynamiczną pliku Lab08-02.exe. Wskazana próbka zawiera fragment

shellcode’u, który zostanie wstrzyknięty do innego procesu oraz uruchomiony. Odpowiedz na

pytania:


### 1. Wskaż proces, w którym następuje iniekcja tego shellcode’u.

Chodzi o systemową przeglądarkę, gdzie kluczem jest żądanie `\\http\\shell\\open\\command`








### 2. Podaj miejsce lokalizacji tego shellcode.


```
0x004012ED
```






### 3. Określ sposób zakodowania tego programu.

Po wielokrotnych próbach niestety nie byłem w stanie znaleźć sposobu zakodowania tego programu


### 4. Wskaż host sieciowy, z którym komunikuje się ten plik.




Rozpocząłem od próby wydobycia samego shellcode 




Następnie za pomocą programu `scdbg` analizuję hex dump shellcode




Stąd idzie wyczytać iż hostem jest następujący adres ip: 192.168.200.2

I łączy się za pomocą portu 13330


### 5. Opisz jego działanie (shellcode).

Łącząc z zależnościami z punktu 1. można stwierdzić iż malware tworzy zdalną konsolę poprzez domyślną przeglądarke systemu z adresem ip 192.168.200.2 na porcie 13330


### Laboratorium 7.1

W tej części laboratorium zostanie zademonstrowane użycie wskaźnika this. Przeanalizuj

złośliwe oprogramowanie (plik Lab09-01.exe). Odpowiedz na poniższe pytania:


### 1. Czy funkcja znajdująca się pod adresem 0x401040 przyjmuje jakieś parametry?




Nie


### 2. Podaj adres URL używany w wywołaniu funkcji URLDownloadToFile.

[http://www.practicalmalwareanalysis.com/cpp.html](http://www.practicalmalwareanalysis.com/cpp.html)



### 3. Opisz działanie tego programu.

Program najprawdopodobniej pobiera jakiś zdalny zasób ze strony [http://www.practicalmalwareanalysis.com/cpp.html](http://www.practicalmalwareanalysis.com/cpp.html)

A następnie zapisuje go w systemie pod wcześniej znalezioną nazwą `tempdownload.exe`

